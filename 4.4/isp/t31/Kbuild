# Create a new variable for the tx-isp-debug.c file
TX_ISP_DEBUG_SRC := $(DIR)/tx-isp-debug.c

# Create a new target for building the tx-isp-debug.a file
$(OUT)-tx-isp-debug-objs := $(TX_ISP_DEBUG_SRC:%.c=%.o)
$(OUT)-tx-isp-debug.a: $($(OUT)-tx-isp-debug-objs)
	$(AR) rcs $@ $^

# Update the SRCS variable to exclude tx-isp-debug.c
SRCS := $(DIR)/tx-isp-module.c

# Update the file extensions from .c to .cpp
SRCS := $(SRCS:%.c=%.cpp)

OBJS := $(SRCS:%.cpp=%.o) $(ASM_SRCS:%.S=%.o)
OBJS += $(KERNEL_VERSION)/sdk/lib$(SOC_FAMILY)-firmware.a

$(OUT)-objs := $(OBJS)

$(info Building with OBJS = $(OBJS))

$(OUT).so: $(OBJS)
	$(CXX) -shared -fPIC $(CFLAGS_MODULE) -o $@ $^


# Remove the kernel object build rule
# obj-m += $(OUT).o